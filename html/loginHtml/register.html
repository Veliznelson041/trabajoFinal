<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Registro de Usuario</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />

    <link rel="stylesheet" href="../../css/loginCss/register.css" />
  </head>
  <body>
    <!-- Encabezado -->
    <header>
      <div class="header-container">
        <img
          src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRt_eZYMvS26mdHNwVQw-zHWqDRdSz5XzAVHQ&s"
          alt="Logo de Suplementos Dynamite"
          class="logo"
        />
        <h1 id="title">Suplementos Dynamite</h1>
      </div>
      <br />
      <p id="date-time"></p>
      <nav class="nav-bar">
        <ul>
          <li><a href="../index.html">Inicio</a></li>
          <li>
            <a href="/html/catalogo-Carrito-Producto-HTML/catalogo.html"
              >Catálogo</a
            >
          </li>
          <li><a href="../contactoHtml/contacto.html">Contacto</a></li>
          <li>
            <a href="/html/loginHtml/login.html" class="btn-login"
              ><i class="fas fa-user"></i> Iniciar Sesión</a
            >
          </li>
        </ul>
      </nav>
    </header>

    <nav class="ruta">
      <a href="../index.html">Inicio</a> &gt;
      <a href="login.html">Iniciar Sesión</a> &gt;
      <a href="../loginHtml/register.html">Registrarse</a>
    </nav>

    <div class="container">
      <h1>Registro de Usuario</h1>
      <form id="register-form">

        <label for="usuario">Nombre de usuario:</label>
        <input type="text" id="usuario" name="usuario" required />
        <small id="help-nombres">No se permiten caracteres especiales ni símbolos.</small>

        <label for="clave">Clave:</label>
        <input type="password" id="clave" name="clave" required />
        <small id="help-nombres">Debe contener como minímo, 1 letra mayuscula, 1 minuscula, 1 número y un caracter especial.</small>

        <!--
        <label for="tipo-usuario">Tipo de usuario</label>
        <select id="tipo-usuario">
          <option value="usuario">Usuario</option>
          <option value="admin">Administrador</option>
        </select>

        -->
        <label for="email">Email:</label>
        <input type="email" id="email" name="email" required />
        <small id="help-nombres">No debe contener caracteres especiales.</small>

        <label for="imagen">Imagen de perfil:</label>
        <input type="file" id="imagen" name="imagen" required />
        <!-- se mostrará una vista previa de la imagen seleccionada -->
        <div id="image-preview-container" style="display: none; margin-top: 10px;">
          <img id="image-preview" src="" alt="Vista previa" style="max-width: 250px; max-height: 250px;">
          <button type="button" id="remove-image" style="display: block; margin-top: 5px;">
            Eliminar imagen
          </button>
        </div>
        <small id="help-imagen">Formatos permitidos: JPG, JPEG o PNG.</small>
        


        <p>
  <a href="../../docs/RegistroUsuario.pdf" download>
    Proceso de registro de usuario (PDF)
  </a>
</p>


        <button type="submit">Registrarse</button>
        <p><a href="../loginHtml/login.html">Volver al inicio de sesión</a></p>
      </form>
    </div>

    <footer>
      <p>
        Dirección: Av. Pres. Arturo Illia 902, Catamarca, Argentina | Email:
        contacto@suplementosdynamite.com | Tel: (123) 456-7890
      </p>
      <div class="social-icons">
        <a href="https://wa.me/1234567890" target="_blank"
          ><i class="fab fa-whatsapp"></i
        ></a>
        <a href="https://www.instagram.com/suplementosdynamite" target="_blank"
          ><i class="fab fa-instagram"></i
        ></a>
      </div>
      <p>&copy; 2024 Suplementos Dynamite. Todos los derechos reservados.</p>
    </footer>

    <script>
      const dateTimeElement = document.getElementById("date-time");
      const updateDateTime = () => {
        const now = new Date();
        dateTimeElement.innerText = now.toLocaleString();
      };
      setInterval(updateDateTime, 1000);
      updateDateTime();

            // Vista previa de imagen
     const imagenInput = document.getElementById('imagen');
     const previewContainer = document.getElementById('image-preview-container');
     const imagePreview = document.getElementById('image-preview');
     const removeButton = document.getElementById('remove-image');

    imagenInput.addEventListener('change', function() {
    if (this.files && this.files[0]) {
      const file = this.files[0];
      const reader = new FileReader();
      
      reader.onload = function(e) {
        imagePreview.src = e.target.result;
        previewContainer.style.display = 'block';
      }
      
      reader.readAsDataURL(file);
    }
    });

    // Eliminar imagen seleccionada
    removeButton.addEventListener('click', function() {
      imagenInput.value = '';
      imagePreview.src = '';
      previewContainer.style.display = 'none';
    });

    // Validar archivo (actualizado)
    function validarArchivo(input) {
      if (!input.files || input.files.length === 0) return false;
      
      const archivo = input.files[0];
      const extensionesPermitidas = ["jpg", "jpeg", "png", "svg"];
      const extension = archivo.name.split('.').pop().toLowerCase();
      
      return extensionesPermitidas.includes(extension);
    }



  // Validaciones comunes
  function soloTexto(valor) {
    return /^[A-Za-zÁÉÍÓÚáéíóúÑñ\s]+$/.test(valor.trim());
  }

  function soloNumeros(valor) {
    return /^\d+$/.test(valor);
  }

  function textoYNumeros(valor) {
    return /^[A-Za-z0-9\s]+$/.test(valor.trim());
  }

  function tieneCaracteresEspeciales(valor) {
    return /[^A-Za-z0-9\s]/.test(valor);
  }

  function validarArchivo(input) {
    const archivo = input.files[0];
    if (!archivo) return false;
    const extensionesPermitidas = ["jpg", "jpeg", "png"];
    const extension = archivo.name.split(".").pop().toLowerCase();
    return extensionesPermitidas.includes(extension);
  }

  function validarFormularioPersona(event) {
    event.preventDefault();

    const nombres = document.getElementById("full-name").value;
    const apellidos = document.querySelectorAll("#full-name")[1].value;
    const dni = document.getElementById("dni").value;
    const calle = document.getElementById("calle").value;
    const imagen = document.getElementById("imagen");

    let errores = [];

    if (!soloTexto(nombres)) errores.push("El nombre debe contener solo letras.");
    //if (!soloTexto(apellidos)) errores.push("El apellido debe contener solo letras.");
    if (!soloNumeros(dni) || dni.length < 7 || dni.length > 8)
      errores.push("El DNI debe tener solo números (7 u 8 dígitos).");
    if (!textoYNumeros(calle)) errores.push("La calle debe contener solo letras y/o números.");
    if (!validarArchivo(imagen)) errores.push("Debe subir una imagen JPG, JPEG o PNG válida.");

    if (errores.length > 0) {
      alert(errores.join("\n"));
    } else {
      alert("Formulario válido. Enviando...");
      // Aquí podrías enviar el formulario si estás conectado a backend
      // e.target.submit();
    }
  }

  function validarFormularioUsuario(event) {
    event.preventDefault();

    const usuario = document.getElementById("usuario").value;
    const clave = document.getElementById("clave").value;
    const email = document.getElementById("email").value;
    const imagen = document.getElementById("imagen");

    let errores = [];

    if (!textoYNumeros(usuario)|| nombres.trim().length < 3) errores.push("El nombre de usuario debe contener solo letras, y tiene que ser igual o mayor a 3 caracteres.");
    if (tieneCaracteresEspeciales(usuario)) errores.push("El nombre de usuario no debe tener caracteres especiales.");
    if (clave.length < 6) errores.push("La clave debe tener al menos 6 caracteres.");
    if (!/\S+@\S+\.\S+/.test(email)) errores.push("Email inválido.");
    if (!validarArchivo(imagen)) errores.push("Debe subir una imagen JPG, JPEG o PNG válida.");

    if (errores.length > 0) {
      alert(errores.join("\n"));
    } else {
      alert("Formulario válido. Enviando...");
      // e.target.submit();
    }
  }

  // Asociar eventos al cargar la página
  document.addEventListener("DOMContentLoaded", () => {
    const formPersona = document.querySelector("#register-form");
    if (formPersona && document.title.includes("Persona")) {
      formPersona.addEventListener("submit", validarFormularioPersona);
    } else if (formPersona && document.title.includes("Usuario")) {
      formPersona.addEventListener("submit", validarFormularioUsuario);
    }
  });




    </script>
  </body>
</html>
